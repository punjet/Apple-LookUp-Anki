# üçé Apple LookUp Anki (Safari Edition)

–í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã—Ö —è–∑—ã–∫–æ–≤ –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ. –°–∫—Ä–∏–ø—Ç –∏–º–∏—Ç–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é "Look Up" –≤ macOS, –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —Å–ª–æ–≤–∞ –Ω–∞ –ª–µ—Ç—É –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏—Ö –≤ Anki —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–π Python-—Å–µ—Ä–≤–µ—Ä.

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∏—à–∫–∏

- **Shift-to-Translate**: –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–µ—Ä–µ–≤–æ–¥–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–∂–∞—Ç–æ–π –∫–ª–∞–≤–∏—à–µ `Shift` ‚Äî –∑–∞–±—É–¥—å—Ç–µ –æ –ª–∏—à–Ω–∏—Ö –ø–æ–ø–∞–ø–∞—Ö.
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Safari**: –°–∫—Ä–∏–ø—Ç –¥–æ–≤–µ–¥–µ–Ω –¥–æ –∏–¥–µ–∞–ª–∞ –≤ Safari Technology Preview. –≠–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Å–Ω–∏–∂–µ–Ω–æ –≤ 5 —Ä–∞–∑ (—Å 57% –¥–æ 7% CPU).
- **Sticky Popup**: –£–º–Ω–∞—è "–∑–æ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏" –≤–æ–∫—Ä—É–≥ –æ–∫–Ω–∞ –ø–µ—Ä–µ–≤–æ–¥–∞ ‚Äî –ø–æ–ø–∞–ø –Ω–µ –∏—Å—á–µ–∑–∞–µ—Ç, –ø–æ–∫–∞ –≤—ã –≤–µ–¥–µ—Ç–µ –∫—É—Ä—Å–æ—Ä –∫ –∫–Ω–æ–ø–∫–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è.
- **Smart Context**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞—Ö–≤–∞—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –≤ –∫–æ—Ç–æ—Ä–æ–º –≤—Å—Ç—Ä–µ—Ç–∏–ª–æ—Å—å —Å–ª–æ–≤–æ. –î–ª–∏–Ω–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≤–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞.
- **Anki Buffer**: –°–ª–æ–≤–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Anki –Ω–∞–ø—Ä—è–º—É—é, –∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π JSON-–±—É—Ñ–µ—Ä. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ –¥–∞–∂–µ –ø—Ä–∏ –≤—ã–∫–ª—é—á–µ–Ω–Ω–æ–º Anki –∏ –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Ä–µ–≤–∏–∑–∏—é —Å–ª–æ–≤ –ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º.

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Client**: JavaScript (Tampermonkey / Userscript).
- **Server**: Python 3 + Flask (–ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä-–±—É—Ñ–µ—Ä).
- **Performance**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `translate3d`, `contain: content`, `requestAnimationFrame` –∏ –æ—Ç–∫–∞–∑ –æ—Ç —Ç—è–∂–µ–ª—ã—Ö CSS-—Ñ–∏–ª—å—Ç—Ä–æ–≤ (blur/shadow) –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è **Medium Energy Impact**.

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å (Python)
–°–µ—Ä–≤–µ—Ä —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–ª–æ–≤–∞ –≤ —Ñ–∞–π–ª `anki_buffer.json`.

```bash
pip install flask flask-cors requests
python server.py
```

### 2. –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å (Userscript)
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ **Tampermonkey** –≤ Safari.
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `apple_lookup.user.js`.
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à Python-—Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É `5005`.

---

## üìñ –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è

1. –ó–∞–∂–º–∏—Ç–µ –∫–ª–∞–≤–∏—à—É **Shift**.
2. –ù–∞–≤–µ–¥–∏—Ç–µ –∫—É—Ä—Å–æ—Ä –Ω–∞ –Ω–µ–∑–Ω–∞–∫–æ–º–æ–µ –∞–Ω–≥–ª–∏–π—Å–∫–æ–µ —Å–ª–æ–≤–æ.
3. –í –ø–æ—è–≤–∏–≤—à–µ–º—Å—è –æ–∫–Ω–µ –≤—ã —É–≤–∏–¥–∏—Ç–µ:
   - –ü–µ—Ä–µ–≤–æ–¥ —Å–ª–æ–≤–∞.
   - –ö–æ–Ω—Ç–µ–∫—Å—Ç (–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ) –∏ –µ–≥–æ –ø–µ—Ä–µ–≤–æ–¥.
4. –ù–∞–∂–º–∏—Ç–µ **"Add to Anki"**. –ö–Ω–æ–ø–∫–∞ —Å—Ç–∞–Ω–µ—Ç –∑–µ–ª–µ–Ω–æ–π, –∏ —Å–ª–æ–≤–æ –ø–æ–ø–∞–¥–µ—Ç –≤ –≤–∞—à –ª–æ–∫–∞–ª—å–Ω—ã–π –±—É—Ñ–µ—Ä.

---

## ‚ö°Ô∏è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –±—ã–ª–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ –≥–ª—É–±–æ–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤—â–∏–∫ Safari. 

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –ü–æ—Å–ª–µ (Zero Paint Edition) |
| :--- | :--- | :--- |
| **Max CPU Usage** | 57.3% | **22.1%** |
| **Average CPU** | ~35% | **7.2%** |
| **Energy Impact** | High | **Medium / Low** |
| **Rendering (Paint)** | –í—ã—Å–æ–∫–∏–π (–∏–∑-–∑–∞ Blur/Shadow) | **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π (GPU accelerated)** |

**–ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:**
- –û—Ç–∫–∞–∑ –æ—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ `Selection API` –≤ –ø–æ–ª—å–∑—É —Ä—É—á–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —É–∑–ª–æ–≤ (—É–±—Ä–∞–ª–æ –ª–∏—à–Ω–∏–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏).
- –ó–∞–º–µ–Ω–∞ `top/left` –Ω–∞ `translate3d` (–ø–µ—Ä–µ–Ω–æ—Å –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–∞ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—É).
- –¢—Ä–æ—Ç—Ç–ª–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π –º—ã—à–∏ (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ–≤–∞ –Ω–µ —á–∞—â–µ 5-8 —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É).
- –ò–∑–æ–ª—è—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ `contain: strict`.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Anki

–°–∫—Ä–∏–ø—Ç –æ–∂–∏–¥–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ –º–æ–¥–µ–ª–∏ –≤ Anki —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–æ–ª—è–º–∏:
- `Word`: –°–∞–º–æ —Å–ª–æ–≤–æ.
- `WordTranslation`: –ü–µ—Ä–µ–≤–æ–¥ —Å–ª–æ–≤–∞.
- `Context`: –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ-–ø—Ä–∏–º–µ—Ä.
- `ContextTranslation`: –ü–µ—Ä–µ–≤–æ–¥ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è.

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è
MIT. –ü–æ–ª—å–∑—É–π—Ç–µ—Å—å –Ω–∞ –∑–¥–æ—Ä–æ–≤—å–µ –∏ —É—á–∏—Ç–µ —è–∑—ã–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ! üìö

